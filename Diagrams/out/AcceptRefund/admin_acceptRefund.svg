<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="965px" preserveAspectRatio="none" style="width:1068px;height:965px;background:#FFFFFF;" version="1.1" viewBox="0 0 1068 965" width="1068px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="81.0547" style="stroke:#000000;stroke-width:1.5;" width="557" x="439.5" y="221.0156"/><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="537" x="449.5" y="246.3672"/><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="435" x="125.5" y="787.6953"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="27" x2="27" y1="82.6094" y2="883.75"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="194.5" x2="194.5" y1="82.6094" y2="883.75"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="504.5" x2="504.5" y1="82.6094" y2="883.75"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="660.5" x2="660.5" y1="82.6094" y2="883.75"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="947.5" x2="947.5" y1="82.6094" y2="883.75"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1026.5" x2="1026.5" y1="82.6094" y2="883.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="5" y="79.5332">admin</text><ellipse cx="27" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M27,21.5 L27,48.5 M14,29.5 L40,29.5 M27,48.5 L14,63.5 M27,48.5 L40,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="5" y="897.2832">admin</text><ellipse cx="27" cy="908.8594" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M27,916.8594 L27,943.8594 M14,924.8594 L40,924.8594 M27,943.8594 L14,958.8594 M27,943.8594 L40,958.8594 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="135.5" y="79.5332">external_interface</text><path d="M174.5,37 L174.5,61 M174.5,49 L191.5,49 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="203.5" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="135.5" y="897.2832">external_interface</text><path d="M174.5,904.3594 L174.5,928.3594 M174.5,916.3594 L191.5,916.3594 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="203.5" cy="916.3594" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="459.5" y="79.5332">EPaymentAPI</text><ellipse cx="505" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="501,37,507,32,505,37,507,42,501,37" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="459.5" y="897.2832">EPaymentAPI</text><ellipse cx="505" cy="916.3594" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="501,904.3594,507,899.3594,505,904.3594,507,909.3594,501,904.3594" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="604.5" y="79.5332">AccountsFetcher</text><path d="M643,29 C643,19 661,19 661,19 C661,19 679,19 679,29 L679,55 C679,65 661,65 661,65 C661,65 643,65 643,55 L643,29 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M643,29 C643,39 661,39 661,39 C661,39 679,39 679,29 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="604.5" y="897.2832">AccountsFetcher</text><path d="M643,910.3594 C643,900.3594 661,900.3594 661,900.3594 C661,900.3594 679,900.3594 679,910.3594 L679,936.3594 C679,946.3594 661,946.3594 661,946.3594 C661,946.3594 643,946.3594 643,936.3594 L643,910.3594 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M643,910.3594 C643,920.3594 661,920.3594 661,920.3594 C661,920.3594 679,920.3594 679,910.3594 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="919.5" y="79.5332">Account</text><ellipse cx="948" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="936" x2="960" y1="63" y2="63"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="919.5" y="897.2832">Account</text><ellipse cx="948" cy="916.3594" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="936" x2="960" y1="930.3594" y2="930.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="986.5" y="79.5332">Transaction</text><ellipse cx="1027" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1015" x2="1039" y1="63" y2="63"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="986.5" y="897.2832">Transaction</text><ellipse cx="1027" cy="916.3594" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1015" x2="1039" y1="930.3594" y2="930.3594"/><polygon fill="#181818" points="183,110.9609,193,114.9609,183,118.9609,187,114.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="27" x2="189" y1="114.9609" y2="114.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="34" y="110.1045">showRefundRequests</text><polygon fill="#181818" points="493,141.3125,503,145.3125,493,149.3125,497,145.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="195" x2="499" y1="145.3125" y2="145.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286" x="202" y="140.4561">{GET} getRefundRequests(adminEmail,password)</text><polygon fill="#181818" points="649,171.6641,659,175.6641,649,179.6641,653,175.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="505" x2="655" y1="175.6641" y2="175.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="512" y="170.8076">getAllAccounts()</text><polygon fill="#181818" points="516,202.0156,506,206.0156,516,210.0156,512,206.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="510" x2="660" y1="206.0156" y2="206.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="522" y="201.1592">returns accounts</text><path d="M439.5,221.0156 L512.5,221.0156 L512.5,229.3672 L502.5,239.3672 L439.5,239.3672 L439.5,221.0156 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="81.0547" style="stroke:#000000;stroke-width:1.5;" width="557" x="439.5" y="221.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="454.5" y="235.5107">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="101" x="527.5" y="234.4346">[i&lt;accounts.size()]</text><path d="M449.5,246.3672 L522.5,246.3672 L522.5,254.7188 L512.5,264.7188 L449.5,264.7188 L449.5,246.3672 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="537" x="449.5" y="246.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="464.5" y="260.8623">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="246" x="537.5" y="259.7861">[j&lt;accounts.get(i).getRefundRequests.size()]</text><polygon fill="#181818" points="936,283.0703,946,287.0703,936,291.0703,940,287.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="505" x2="942" y1="287.0703" y2="287.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419" x="512" y="282.2139">accounts.get(i).getTransaction(accounts.get(i).getRefundRequests.get(j))</text><polygon fill="#181818" points="206,327.4219,196,331.4219,206,335.4219,202,331.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="200" x2="504" y1="331.4219" y2="331.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="212" y="326.5654">returns refundRequests</text><polygon fill="#181818" points="38,357.7734,28,361.7734,38,365.7734,34,361.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="32" x2="194" y1="361.7734" y2="361.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="44" y="356.917">returns refundRequests</text><polygon fill="#181818" points="183,388.125,193,392.125,183,396.125,187,392.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="27" x2="189" y1="392.125" y2="392.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="34" y="387.2686">AcceptRefundRequest(0)</text><polygon fill="#181818" points="493,418.4766,503,422.4766,493,426.4766,497,422.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="195" x2="499" y1="422.4766" y2="422.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217" x="202" y="417.6201">{POST} processRefundRequest(body)</text><polygon fill="#181818" points="649,448.8281,659,452.8281,649,456.8281,653,452.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="505" x2="655" y1="452.8281" y2="452.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="512" y="447.9717">getAccount(userEmail)</text><polygon fill="#181818" points="516,479.1797,506,483.1797,516,487.1797,512,483.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="510" x2="660" y1="483.1797" y2="483.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="522" y="478.3232">returns account</text><polygon fill="#181818" points="936,509.5313,946,513.5313,936,517.5313,940,513.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="505" x2="942" y1="513.5313" y2="513.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="512" y="508.6748">getTransaction(transacionID)</text><polygon fill="#181818" points="516,539.8828,506,543.8828,516,547.8828,512,543.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="510" x2="947" y1="543.8828" y2="543.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="522" y="539.0264">returns Transaction</text><polygon fill="#181818" points="936,586.5859,946,590.5859,936,594.5859,940,590.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="505" x2="942" y1="590.5859" y2="590.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306" x="512" y="569.3779">addTransaction(new Transaction with type refund and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264" x="512" y="585.7295">-ve the ammount of the accepted Transaction)</text><polygon fill="#181818" points="1015,616.9375,1025,620.9375,1015,624.9375,1019,620.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="505" x2="1021" y1="620.9375" y2="620.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="512" y="616.0811">getAmount()</text><polygon fill="#181818" points="516,647.2891,506,651.2891,516,655.2891,512,651.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="510" x2="1026" y1="651.2891" y2="651.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="522" y="646.4326">returns amount</text><polygon fill="#181818" points="936,677.6406,946,681.6406,936,685.6406,940,681.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="505" x2="942" y1="681.6406" y2="681.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="512" y="676.7842">getWalletBalance()</text><polygon fill="#181818" points="516,707.9922,506,711.9922,516,715.9922,512,711.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="510" x2="947" y1="711.9922" y2="711.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="522" y="707.1357">returns walletBalance</text><polygon fill="#181818" points="936,738.3438,946,742.3438,936,746.3438,940,742.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="505" x2="942" y1="742.3438" y2="742.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241" x="512" y="737.4873">setWalletBalance(amount+walletBalance)</text><polygon fill="#181818" points="936,768.6953,946,772.6953,936,776.6953,940,772.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="505" x2="942" y1="772.6953" y2="772.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="512" y="767.8389">removeRefundRequest(TransactionID)</text><path d="M125.5,787.6953 L186.5,787.6953 L186.5,796.0469 L176.5,806.0469 L125.5,806.0469 L125.5,787.6953 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="435" x="125.5" y="787.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="140.5" y="802.1904">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140" x="201.5" y="801.1143">[if any get operation fails]</text><polygon fill="#181818" points="206,824.3984,196,828.3984,206,832.3984,202,828.3984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="200" x2="504" y1="828.3984" y2="828.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="212" y="823.542">returns error</text><polygon fill="#181818" points="206,861.75,196,865.75,206,869.75,202,865.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="200" x2="504" y1="865.75" y2="865.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="212" y="860.8936">returns 0</text><!--MD5=[6b680086135c8207cee010ca736ef7f2]
@startuml admin_acceptRefund

actor admin
boundary external_interface as external_interface
control EPaymentAPI as EPaymentAPI
database AccountsFetcher as AccountsFetcher
entity Account as Account
entity Transaction as Transaction
admin->external_interface:showRefundRequests
external_interface->EPaymentAPI:{GET} getRefundRequests(adminEmail,password)
EPaymentAPI->AccountsFetcher:getAllAccounts()
AccountsFetcher- ->EPaymentAPI:returns accounts

loop i<accounts.size()
    loop j<accounts.get(i).getRefundRequests.size()
    EPaymentAPI->Account:accounts.get(i).getTransaction(accounts.get(i).getRefundRequests.get(j))
    end    
end

EPaymentAPI- ->external_interface:returns refundRequests
external_interface- ->admin:returns refundRequests
admin->external_interface:AcceptRefundRequest(0)
external_interface->EPaymentAPI:{POST} processRefundRequest(body)
EPaymentAPI->AccountsFetcher:getAccount(userEmail)
AccountsFetcher- ->EPaymentAPI:returns account
EPaymentAPI->Account:getTransaction(transacionID)
Account- ->EPaymentAPI:returns Transaction
EPaymentAPI->Account:addTransaction(new Transaction with type refund and \n-ve the ammount of the accepted Transaction)
EPaymentAPI->Transaction:getAmount()
Transaction- ->EPaymentAPI:returns amount
EPaymentAPI->Account:getWalletBalance()
Account- ->EPaymentAPI:returns walletBalance
EPaymentAPI->Account:setWalletBalance(amount+walletBalance)
EPaymentAPI->Account:removeRefundRequest(TransactionID)
alt if any get operation fails
    EPaymentAPI- ->external_interface:returns error
end
EPaymentAPI- ->external_interface:returns 0
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 EET 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>