<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1189px" preserveAspectRatio="none" style="width:1196px;height:1189px;background:#FFFFFF;" version="1.1" viewBox="0 0 1196 1189" width="1196px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="549" x="39" y="190.6641"/><rect fill="none" height="137.4063" style="stroke:#000000;stroke-width:1.5;" width="463" x="435" y="387.7734"/><rect fill="none" height="105.0547" style="stroke:#000000;stroke-width:1.5;" width="443" x="445" y="413.125"/><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="549" x="39" y="539.1797"/><rect fill="none" height="137.4063" style="stroke:#000000;stroke-width:1.5;" width="712" x="435" y="705.9375"/><rect fill="none" height="105.0547" style="stroke:#000000;stroke-width:1.5;" width="692" x="445" y="731.2891"/><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="549" x="39" y="857.3438"/><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="549" x="39" y="950.3984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="22" x2="22" y1="82.6094" y2="1107.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="108" x2="108" y1="82.6094" y2="1107.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="516" x2="516" y1="82.6094" y2="1107.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="657" x2="657" y1="82.6094" y2="1107.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="785" x2="785" y1="82.6094" y2="1107.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="901" x2="901" y1="82.6094" y2="1107.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="986" x2="986" y1="82.6094" y2="1107.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1050" x2="1050" y1="82.6094" y2="1107.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1139" x2="1139" y1="82.6094" y2="1107.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="5" y="79.5332">user</text><ellipse cx="22" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22,21.5 L22,48.5 M9,29.5 L35,29.5 M22,48.5 L9,63.5 M22,48.5 L35,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="5" y="1120.6895">user</text><ellipse cx="22" cy="1132.2656" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22,1140.2656 L22,1167.2656 M9,1148.2656 L35,1148.2656 M22,1167.2656 L9,1182.2656 M22,1167.2656 L35,1182.2656 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="49" y="79.5332">external_Interface</text><path d="M88,37 L88,61 M88,49 L105,49 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="117" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="49" y="1120.6895">external_Interface</text><path d="M88,1127.7656 L88,1151.7656 M88,1139.7656 L105,1139.7656 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="117" cy="1139.7656" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="455" y="79.5332">PaymentController</text><ellipse cx="516.5" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="512.5,37,518.5,32,516.5,37,518.5,42,512.5,37" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="455" y="1120.6895">PaymentController</text><ellipse cx="516.5" cy="1139.7656" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="512.5,1127.7656,518.5,1122.7656,516.5,1127.7656,518.5,1132.7656,512.5,1127.7656" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="596" y="79.5332">DiscountController</text><ellipse cx="657.5" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="653.5,37,659.5,32,657.5,37,659.5,42,653.5,37" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="596" y="1120.6895">DiscountController</text><ellipse cx="657.5" cy="1139.7656" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="653.5,1127.7656,659.5,1122.7656,657.5,1127.7656,659.5,1132.7656,653.5,1127.7656" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="729" y="79.5332">accountsFetcher</text><ellipse cx="785" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="773" x2="797" y1="63" y2="63"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="729" y="1120.6895">accountsFetcher</text><ellipse cx="785" cy="1139.7656" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="773" x2="797" y1="1153.7656" y2="1153.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="851" y="79.5332">serviceFetcher</text><ellipse cx="901" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="889" x2="913" y1="63" y2="63"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="851" y="1120.6895">serviceFetcher</text><ellipse cx="901" cy="1139.7656" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="889" x2="913" y1="1153.7656" y2="1153.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="961" y="79.5332">service</text><ellipse cx="986.5" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="974.5" x2="998.5" y1="63" y2="63"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="961" y="1120.6895">service</text><ellipse cx="986.5" cy="1139.7656" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="974.5" x2="998.5" y1="1153.7656" y2="1153.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="1022" y="79.5332">account</text><ellipse cx="1050" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1038" x2="1062" y1="63" y2="63"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="1022" y="1120.6895">account</text><ellipse cx="1050" cy="1139.7656" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1038" x2="1062" y1="1153.7656" y2="1153.7656"/><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102" x="1088" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="1095" y="71.5332">CashPayment</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102" x="1088" y="1106.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="1095" y="1127.6895">CashPayment</text><polygon fill="#181818" points="96.5,110.9609,106.5,114.9609,96.5,118.9609,100.5,114.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="22" x2="102.5" y1="114.9609" y2="114.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="29" y="110.1045">pay</text><polygon fill="#181818" points="504.5,141.3125,514.5,145.3125,504.5,149.3125,508.5,145.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="108.5" x2="510.5" y1="145.3125" y2="145.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="115.5" y="140.4561">{POST} pay(body)</text><polygon fill="#181818" points="773,171.6641,783,175.6641,773,179.6641,777,175.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="516.5" x2="779" y1="175.6641" y2="175.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="523.5" y="170.8076">getAccount(userEmail,password);</text><path d="M39,190.6641 L100,190.6641 L100,199.0156 L90,209.0156 L39,209.0156 L39,190.6641 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="549" x="39" y="190.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="54" y="205.1592">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="89" x="115" y="204.083">[account == null]</text><polygon fill="#181818" points="119.5,227.3672,109.5,231.3672,119.5,235.3672,115.5,231.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="113.5" x2="515.5" y1="231.3672" y2="231.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="323" x="125.5" y="226.5107">throw new IllegalAccessError("Account does not exist");</text><polygon fill="#181818" points="889,264.7188,899,268.7188,889,272.7188,893,268.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="516.5" x2="895" y1="268.7188" y2="268.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="523.5" y="263.8623">getServices(serviceName)</text><line style="stroke:#181818;stroke-width:1.0;" x1="901" x2="943" y1="299.0703" y2="299.0703"/><line style="stroke:#181818;stroke-width:1.0;" x1="943" x2="943" y1="299.0703" y2="312.0703"/><line style="stroke:#181818;stroke-width:1.0;" x1="902" x2="943" y1="312.0703" y2="312.0703"/><polygon fill="#181818" points="912,308.0703,902,312.0703,912,316.0703,908,312.0703" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="908" y="294.2139">get(0)</text><polygon fill="#181818" points="527.5,338.4219,517.5,342.4219,527.5,346.4219,523.5,342.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="521.5" x2="900" y1="342.4219" y2="342.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="533.5" y="337.5654">return service</text><polygon fill="#181818" points="974.5,368.7734,984.5,372.7734,974.5,376.7734,978.5,372.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="516.5" x2="980.5" y1="372.7734" y2="372.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="523.5" y="367.917">getServiceProviders();</text><path d="M435,387.7734 L508,387.7734 L508,396.125 L498,406.125 L435,406.125 L435,387.7734 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="137.4063" style="stroke:#000000;stroke-width:1.5;" width="463" x="435" y="387.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="450" y="402.2686">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="152" x="523" y="401.1924">[i &lt; serviceProviders.size()]</text><path d="M445,413.125 L506,413.125 L506,421.4766 L496,431.4766 L445,431.4766 L445,413.125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="105.0547" style="stroke:#000000;stroke-width:1.5;" width="443" x="445" y="413.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="460" y="427.6201">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="362" x="521" y="426.5439">[serviceProviders.get(i).getName().equals(serviceProviderName)]</text><line style="stroke:#181818;stroke-width:1.0;" x1="516.5" x2="558.5" y1="453.8281" y2="453.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="558.5" x2="558.5" y1="453.8281" y2="466.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="517.5" x2="558.5" y1="466.8281" y2="466.8281"/><polygon fill="#181818" points="527.5,462.8281,517.5,466.8281,527.5,470.8281,523.5,466.8281" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="523.5" y="448.9717">boolean found = true</text><line style="stroke:#181818;stroke-width:1.0;" x1="516.5" x2="558.5" y1="497.1797" y2="497.1797"/><line style="stroke:#181818;stroke-width:1.0;" x1="558.5" x2="558.5" y1="497.1797" y2="510.1797"/><line style="stroke:#181818;stroke-width:1.0;" x1="517.5" x2="558.5" y1="510.1797" y2="510.1797"/><polygon fill="#181818" points="527.5,506.1797,517.5,510.1797,527.5,514.1797,523.5,510.1797" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="523.5" y="492.3232">break loop</text><path d="M39,539.1797 L100,539.1797 L100,547.5313 L90,557.5313 L39,557.5313 L39,539.1797 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="549" x="39" y="539.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="54" y="553.6748">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="43" x="115" y="552.5986">[!found]</text><polygon fill="#181818" points="119.5,575.8828,109.5,579.8828,119.5,583.8828,115.5,579.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="113.5" x2="515.5" y1="579.8828" y2="579.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="384" x="125.5" y="575.0264">throw new IllegalAccessError("Service/ServiceProvider not found.");</text><line style="stroke:#181818;stroke-width:1.0;" x1="516.5" x2="558.5" y1="617.2344" y2="617.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="558.5" x2="558.5" y1="617.2344" y2="630.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="517.5" x2="558.5" y1="630.2344" y2="630.2344"/><polygon fill="#181818" points="527.5,626.2344,517.5,630.2344,527.5,634.2344,523.5,630.2344" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="523.5" y="612.3779">payment type = 'cash'</text><polygon fill="#181818" points="1127,656.5859,1137,660.5859,1127,664.5859,1131,660.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="516.5" x2="1133" y1="660.5859" y2="660.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="523.5" y="655.7295">new CashPayment()</text><polygon fill="#181818" points="974.5,686.9375,984.5,690.9375,974.5,694.9375,978.5,690.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="516.5" x2="980.5" y1="690.9375" y2="690.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="523.5" y="686.0811">getAllPaymentTypes()</text><path d="M435,705.9375 L508,705.9375 L508,714.2891 L498,724.2891 L435,724.2891 L435,705.9375 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="137.4063" style="stroke:#000000;stroke-width:1.5;" width="712" x="435" y="705.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="450" y="720.4326">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="189" x="523" y="719.3564">[i &lt; acceptedPaymentTypes.size()]</text><path d="M445,731.2891 L506,731.2891 L506,739.6406 L496,749.6406 L445,749.6406 L445,731.2891 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="105.0547" style="stroke:#000000;stroke-width:1.5;" width="692" x="445" y="731.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="460" y="745.7842">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="611" x="521" y="744.708">[acceptedPaymentTypes.get(i).getClass().getSimpleName().equals(paymentType.getClass().getSimpleName())]</text><line style="stroke:#181818;stroke-width:1.0;" x1="516.5" x2="558.5" y1="771.9922" y2="771.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="558.5" x2="558.5" y1="771.9922" y2="784.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="517.5" x2="558.5" y1="784.9922" y2="784.9922"/><polygon fill="#181818" points="527.5,780.9922,517.5,784.9922,527.5,788.9922,523.5,784.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="523.5" y="767.1357">boolean found = true</text><line style="stroke:#181818;stroke-width:1.0;" x1="516.5" x2="558.5" y1="815.3438" y2="815.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="558.5" x2="558.5" y1="815.3438" y2="828.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="517.5" x2="558.5" y1="828.3438" y2="828.3438"/><polygon fill="#181818" points="527.5,824.3438,517.5,828.3438,527.5,832.3438,523.5,828.3438" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="523.5" y="810.4873">break loop</text><path d="M39,857.3438 L100,857.3438 L100,865.6953 L90,875.6953 L39,875.6953 L39,857.3438 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="549" x="39" y="857.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="54" y="871.8389">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="43" x="115" y="870.7627">[!found]</text><polygon fill="#181818" points="119.5,894.0469,109.5,898.0469,119.5,902.0469,115.5,898.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="113.5" x2="515.5" y1="898.0469" y2="898.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353" x="125.5" y="893.1904">throw new IllegalAccessError("Payment Method not allowed")</text><polygon fill="#181818" points="1127,931.3984,1137,935.3984,1127,939.3984,1131,935.3984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="516.5" x2="1133" y1="935.3984" y2="935.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="523.5" y="930.542">pay()</text><path d="M39,950.3984 L100,950.3984 L100,958.75 L90,968.75 L39,968.75 L39,950.3984 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="549" x="39" y="950.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="54" y="964.8936">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="143" x="115" y="963.8174">[!paymentType.Pay(body)]</text><polygon fill="#181818" points="119.5,987.1016,109.5,991.1016,119.5,995.1016,115.5,991.1016" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="113.5" x2="515.5" y1="991.1016" y2="991.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="322" x="125.5" y="986.2451">throw new  IllegalAccessError("Error payment method.")</text><polygon fill="#181818" points="1038,1024.4531,1048,1028.4531,1038,1032.4531,1042,1028.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="516.5" x2="1044" y1="1028.4531" y2="1028.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291" x="523.5" y="1023.5967">addTransaction(new Transaction(transaction args))</text><polygon fill="#181818" points="1038,1054.8047,1048,1058.8047,1038,1062.8047,1042,1058.8047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="516.5" x2="1044" y1="1058.8047" y2="1058.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="414" x="523.5" y="1053.9482">getTransaction(account.getAllTransactions().size()-1).getTransactionID()</text><polygon fill="#181818" points="119.5,1085.1563,109.5,1089.1563,119.5,1093.1563,115.5,1089.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="113.5" x2="515.5" y1="1089.1563" y2="1089.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="125.5" y="1084.2998">return transaction</text><!--MD5=[e5475a1a22df86c0e7971d040874a18a]
@startuml userPayTransaction

actor user
boundary external_Interface
control PaymentController
control DiscountController
entity accountsFetcher
entity serviceFetcher
entity service
entity account

user -> external_Interface : pay
external_Interface -> PaymentController : {POST} pay(body)

PaymentController -> accountsFetcher : getAccount(userEmail,password);

alt account == null
    PaymentController - -> external_Interface : throw new IllegalAccessError("Account does not exist");
end

PaymentController -> serviceFetcher : getServices(serviceName)
serviceFetcher -> serviceFetcher : get(0)
serviceFetcher - -> PaymentController : return service
PaymentController -> service : getServiceProviders();

loop i < serviceProviders.size()
    alt serviceProviders.get(i).getName().equals(serviceProviderName)
        PaymentController -> PaymentController : boolean found = true
        PaymentController -> PaymentController : break loop
    end
end

alt !found
    PaymentController - -> external_Interface : throw new IllegalAccessError("Service/ServiceProvider not found.");
end

PaymentController -> PaymentController : payment type = 'cash'
PaymentController -> CashPayment: new CashPayment()

PaymentController -> service : getAllPaymentTypes()

loop i < acceptedPaymentTypes.size()
    alt acceptedPaymentTypes.get(i).getClass().getSimpleName().equals(paymentType.getClass().getSimpleName())
        PaymentController -> PaymentController : boolean found = true
        PaymentController -> PaymentController : break loop
    end
end

alt !found
    PaymentController - -> external_Interface : throw new IllegalAccessError("Payment Method not allowed")
end

PaymentController -> CashPayment: pay()
alt !paymentType.Pay(body)
    PaymentController - -> external_Interface : throw new  IllegalAccessError("Error payment method.")
end

PaymentController -> account : addTransaction(new Transaction(transaction args))
PaymentController -> account : getTransaction(account.getAllTransactions().size()-1).getTransactionID()
PaymentController - -> external_Interface : return transaction

@enduml 

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 EET 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>